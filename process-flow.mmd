flowchart TD
    %% Start
    A[ðŸ“± Application Makes API Call] --> B{ðŸ” API Tracker Middleware}
    
    %% API Tracking Process
    B --> C[ðŸ“ Log API Call Details]
    C --> D[â±ï¸ Record Start Time]
    D --> E[ðŸŒ Execute External API Call]
    
    %% API Response Handling
    E --> F{âœ… API Call Success?}
    F -->|Yes| G[ðŸ“Š Calculate Response Time]
    F -->|No| H[âŒ Log Error Details]
    
    %% Cost Calculation
    G --> I[ðŸ’° Cost Calculator]
    H --> I
    I --> J[ðŸ“‹ Get Pricing Rules]
    J --> K[ðŸ§® Calculate Estimated Cost]
    
    %% Data Storage
    K --> L[ðŸ’¾ Save API Log to MongoDB]
    L --> M[ðŸ”„ Update Real-time Dashboard]
    
    %% Analytics & Processing
    M --> N[ðŸ“ˆ Analytics Processing]
    N --> O{ðŸš¨ Anomaly Detection}
    O -->|Anomaly Detected| P[ðŸ”” Trigger Alert]
    O -->|Normal Usage| Q[ðŸ“Š Update Analytics]
    
    %% Budget & Optimization
    P --> R[ðŸ’³ Budget Controller]
    Q --> R
    R --> S{ðŸ’¸ Budget Exceeded?}
    S -->|Yes| T[ðŸš¨ Budget Alert]
    S -->|No| U[âœ… Continue Monitoring]
    
    %% Optimization Engine
    T --> V[âš™ï¸ Optimization Engine]
    U --> V
    V --> W[ðŸ’¡ Generate Suggestions]
    W --> X[ðŸ“‹ Display Recommendations]
    
    %% User Interaction Points
    Y[ðŸ‘¤ User Views Dashboard] --> Z[ðŸ“Š Real-time Analytics]
    Z --> AA[ðŸ“ API Logs View]
    AA --> BB[ðŸ’° Cost Breakdown]
    BB --> CC[ðŸŽ¯ Optimization Tips]
    
    %% Admin Functions
    DD[ðŸ‘¨â€ðŸ’¼ Admin User] --> EE[âš™ï¸ Manage Pricing Rules]
    DD --> FF[ðŸ’° Set Budgets]
    DD --> GG[ðŸ”” Configure Alerts]
    
    %% Data Flow Connections
    L -.-> Z
    W -.-> CC
    EE --> J
    FF --> R
    GG --> P
    
    %% Styling with colors
    classDef processClass fill:#e3f2fd,stroke:#1976d2,stroke-width:2px
    classDef decisionClass fill:#fff3e0,stroke:#f57c00,stroke-width:2px
    classDef dataClass fill:#e8f5e8,stroke:#388e3c,stroke-width:2px
    classDef alertClass fill:#ffebee,stroke:#d32f2f,stroke-width:2px
    classDef userClass fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px
    classDef externalClass fill:#fce4ec,stroke:#c2185b,stroke-width:2px
    
    class A,C,D,E,G,I,J,K,L,M,N,V,W processClass
    class B,F,O,S decisionClass
    class L,AA,BB,Z dataClass
    class H,P,T alertClass
    class Y,DD,X,CC,EE,FF,GG userClass
    class E externalClass